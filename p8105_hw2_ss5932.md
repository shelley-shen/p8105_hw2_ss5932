Homework 2
================
Shelley Shen
09/26/2020

``` r
library(tidyverse)
```

    ## -- Attaching packages ---------------------------------------------- tidyverse 1.3.0 --

    ## v ggplot2 3.3.2     v purrr   0.3.4
    ## v tibble  3.0.3     v dplyr   1.0.2
    ## v tidyr   1.1.2     v stringr 1.4.0
    ## v readr   1.3.1     v forcats 0.5.0

    ## -- Conflicts ------------------------------------------------- tidyverse_conflicts() --
    ## x dplyr::filter() masks stats::filter()
    ## x dplyr::lag()    masks stats::lag()

``` r
library(readxl)
library(dplyr)
library(readr)
```

## Problem 1: Mr. Trash Wheel

Read and clean the Mr. Trash Wheel sheet.

``` r
trashwheel_df = 
  read_xlsx("./data/Trash-Wheel-Collection-Totals-8-6-19.xlsx",
    sheet = "Mr. Trash Wheel",   
    range = cell_cols("A:N")) %>% 
  janitor::clean_names() %>% 
  drop_na(dumpster) %>% 
  mutate(
    sports_balls = round(sports_balls),
    sports_balls = as.integer(sports_balls)
  )
```

Read and clean precipitation data for 2018 and 2017.

``` r
precip_2018 = 
  read_xlsx(
    "./data/Trash-Wheel-Collection-Totals-8-6-19.xlsx", 
    sheet = "2018 Precipitation", 
    skip = 1, 
  ) %>% 
  janitor::clean_names() %>% 
  drop_na(month) %>% 
  mutate(year = 2018,
         total = as.numeric(total)) %>%
  relocate(year)

precip_2017 = 
  read_xlsx(
    "./data/Trash-Wheel-Collection-Totals-8-6-19.xlsx", 
    sheet = "2017 Precipitation", 
    skip = 1, 
  ) %>% 
  janitor::clean_names() %>% 
  drop_na(month) %>% 
  mutate(year = 2017) %>%
  relocate(year)
```

Now combine annual precipitation and change month number to name by
creating separate month tibble.

``` r
month_df = 
  tibble(
    month = 1:12, 
    month_name = month.name
  )

precip_df = 
  bind_rows(precip_2018, precip_2017)

left_join(precip_df, month_df, by = "month")
```

    ## # A tibble: 24 x 4
    ##     year month total month_name
    ##    <dbl> <dbl> <dbl> <chr>     
    ##  1  2018     1  0.94 January   
    ##  2  2018     2  4.8  February  
    ##  3  2018     3  2.69 March     
    ##  4  2018     4  4.69 April     
    ##  5  2018     5  9.27 May       
    ##  6  2018     6  4.77 June      
    ##  7  2018     7 10.2  July      
    ##  8  2018     8  6.45 August    
    ##  9  2018     9 10.5  September 
    ## 10  2018    10  2.12 October   
    ## # ... with 14 more rows

This dataset contains information from the Mr. Trash Wheel trash
collector in Baltimore, Maryland. As trash enters the inner harbor, the
trash wheel collects that trash and stores it in a dumpster. The dataset
contains information on year, month, and trash collected, including some
specific kinds of trash. There are a total of 14 columns and 344 rows in
our final dataset. Additional data sheets include month and
precipitation data for each year between 2014-2019.

  - The total precipitation in 2018 was 70.33inches.

  - The median number of sports balls in a dumpster in 2017 was 8 balls.

## Problem 2: NYC Transit

*Part 1: Read and clean the NYC Transit data.*

``` r
nyc_transit_df = 
  read_csv("./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv") %>% 
  janitor::clean_names() %>% 
  select(line:entry, vending, ada) %>%
  mutate(entry = recode(entry, "YES" = "TRUE", "NO" = "FALSE")) 
```

    ## Parsed with column specification:
    ## cols(
    ##   .default = col_character(),
    ##   `Station Latitude` = col_double(),
    ##   `Station Longitude` = col_double(),
    ##   Route8 = col_double(),
    ##   Route9 = col_double(),
    ##   Route10 = col_double(),
    ##   Route11 = col_double(),
    ##   ADA = col_logical(),
    ##   `Free Crossover` = col_logical(),
    ##   `Entrance Latitude` = col_double(),
    ##   `Entrance Longitude` = col_double()
    ## )

    ## See spec(...) for full column specifications.

The data is not tidy yet as each route is a distinct variable and needs
to be further cleaned by converting the route variables into the same
type of vector and then using pivot\_longer to merge the routes into one
variable.

``` r
nyc_transit_tidy = 
  nyc_transit_df %>% 
    mutate(
      route8 = as.character(route8), 
      route9 = as.character(route9),
      route10 = as.character(route10), 
      route11 = as.character(route11))

nyc_transit_tidy = 
  pivot_longer(
    nyc_transit_tidy, 
    route1:route11, 
    names_to = "route_name", 
    names_prefix = "route",
    values_to = "route_number")

view(nyc_transit_tidy)
```

The NYC Transit dataset contains a variety of variables pertaining to
the NYC transit system. After reading in the csv file, I cleaned the
data by first cleaning the names to make all variable names in the same
format with lowercase letters and snake case. Then, I used the select
command to retain only the variables of interest and omit all other
extraneous variables. The following variables are those of interest:
line, station, name, station latitude and longitude, routes served,
entry, entrance type, vending, and ADA compliance. Next, I converted the
“entry” variable from the original character vector into a logical
vector by using the recode function embedded in the mutate function. In
an effort to make the data more tidy, I converted all the route
variables into character vectors so they can be merged via pivot\_longer
and all the routes are under only two columns.

The resulting dataset contains a total of 20548 observations with 20548
rows and 10 columns. The variables in the dataset are line,
station\_name, station\_latitude, station\_longitude, entrance\_type,
entry, vending, ada, route\_name, route\_number. The data is quite tidy
now.

*Part 2: Details about the data.*

Find the number of distant stations, the number of ADA compliant
stations, and the proportion of station entrances and exits without
vending that allow entrance.

  - There are 465 number of distinct stations in the NYC transit system.

  - There are 84 distinct stations that are ADA compliant.

  - The proportion of station entrances/exits without vending that allow
    entrance is 0.3770492.

  - There are 60 distinct stations that serve the A train.

  - There are 17 distinct stations that serve the A train and are ADA
    compliant.

## Problem 3: FiveThirtyEight

**Part 1: pols data** Read and clean data in pols-month csv file. I will
first separate the date variable into year, month, and day and then
remove the day variable. Then I will create a president variable and
remove the variables used to create it.

``` r
pols_df = 
  read_csv("./data/538_data/pols-month.csv") %>% 
  janitor::clean_names() %>% 
  separate(mon, c("year", "month", "day")) %>% 
  mutate(
    month = month.abb[as.factor(month)],
    year = as.factor(year),
    president = case_when( 
     prez_gop == 1 ~ "gop",
     prez_dem == 1 ~ "dem",
     prez_gop == 2 ~ "gop"
    )) %>% 
  subset(select = -c(day, prez_gop, prez_dem))
```

    ## Parsed with column specification:
    ## cols(
    ##   mon = col_date(format = ""),
    ##   prez_gop = col_double(),
    ##   gov_gop = col_double(),
    ##   sen_gop = col_double(),
    ##   rep_gop = col_double(),
    ##   prez_dem = col_double(),
    ##   gov_dem = col_double(),
    ##   sen_dem = col_double(),
    ##   rep_dem = col_double()
    ## )

**Part 2: snp data** Read and clean data in snp csv file using the same
process as above. I will first separate the date variable into separate
year, month, and day columns, then remove the day variable.

``` r
snp_df = 
  read_csv("./data/538_data/snp.csv") %>% 
  janitor::clean_names() %>% 
  separate(date, c("month", "day", "year")) %>%
  mutate(
    month = month.abb[as.factor(month)],
    year = as.factor(year)) %>% 
  subset(select = -c(day)) %>% 
  relocate(year, month)
```

    ## Parsed with column specification:
    ## cols(
    ##   date = col_character(),
    ##   close = col_double()
    ## )

**Part 3: unemployment data**
